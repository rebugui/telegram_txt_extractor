# telegram_txt_extractor
#[API] 텔레그램 txt 파일 다운로드 및 계정 노출 확인 코드
이 코드는 텔레그램 채널에서 공유되는 `.txt` 파일을 다운로드한 후, 특정 도메인과 관련된 정보를 분석하여 CSV 파일에 저장합니다. 이를 통해 계정 노출 여부를 확인할 수 있습니다. 아래는 각 기능의 동작과 설정 방법에 대한 설명입니다.

---

## 1. **필수 구성 요소**

### 1.1 사전 준비

- Python 3.x 설치
- 다음 라이브러리 설치:
    
    ```bash
    pip install telethon pytz
    
    ```
    

### 1.2 Telegram API 정보 설정

- 텔레그램 개발자 포털([https://my.telegram.org)에서](https://my.telegram.xn--org)-ej5r32t/) API ID와 API Hash를 생성합니다.
- 아래 정보 입력:
    
    ```python
    api_id = 'YOUR_API_ID'         # 생성한 API ID
    api_hash = 'YOUR_API_HASH'     # 생성한 API Hash
    phone_number = '+8210XXXXYYYY' # 등록된 전화번호
    
    ```
    

---

## 2. **코드 기능 설명**

### 2.1 파일 저장 경로

- 다운로드한 파일은 `./downloads` 경로에 저장됩니다.
- 채널 이름에 따라 하위 디렉토리가 생성됩니다.

---

### 2.2 주요 기능

### 2.2.1 텔레그램 채널에서 txt 파일 다운로드

- 채널에서 `.txt` 확장자를 가진 파일만 다운로드합니다.
- 파일 이름은 아래 형식으로 저장됩니다:
    
    ```
    YYYYMMDD_HHMMSS_원본파일명.txt
    
    ```
    
- 24시간 이내에 업로드된 파일만 처리합니다.

### 2.2.2 txt 파일 내용 분석

- 다운로드된 텍스트 파일에서 특정 도메인과 관련된 정보를 추출합니다.
- 검색 대상 도메인:
    - `assembly.go.kr`
    - `nanet.go.kr`
    - `nabo.go.kr`
    - `na.go.kr`
    - `nars.go.kr`

### 2.2.3 결과 저장

- 추출된 데이터는 `output.csv` 파일에 저장됩니다.
- CSV 저장 형식:
    - 채널 이름
    - 파일 이름
    - 도메인 (Line1)
    - 세부 정보 (Line2, Line3)
    - 파일 생성 시간

---

## 3. **코드 사용 방법**

### 3.1 실행하기

1. API 정보를 설정한 후, 코드를 실행합니다:
    
    ```bash
    python telegram_downloader.py
    
    ```
    
2. 실행 후, 프로그램은 텔레그램 계정의 채널 목록을 확인하고 파일을 다운로드 및 분석합니다.

---

### 3.2 출력 및 로그

- 프로그램 실행 중 출력되는 정보:
    - 다운로드 중인 파일 이름
    - 작성 시간
    - 파일 처리 결과
- 다운로드된 파일은 `./downloads` 폴더에 저장됩니다.
- 결과 데이터는 `output.csv` 파일에 저장됩니다.

---

## 4. **코드 주요 부분 상세 설명**

### 4.1 `format_file_name` 함수

- 파일명을 "작성 시간 + 원본 파일명" 형식으로 변환합니다.

### 4.2 `download_files_from_channel` 함수

- 각 채널에서 메시지를 순회하며 `.txt` 파일을 다운로드합니다.
- 작성 시간이 24시간 이상 지난 파일은 무시됩니다.

### 4.3 `process_text_files` 함수

- 텍스트 파일에서 특정 도메인을 포함한 정보를 추출하고 CSV에 저장합니다.
- 중복 데이터를 방지하기 위해 기존 데이터를 메모리에 저장하고 확인합니다.

---

## 5. **주의 사항**

- API ID와 Hash는 외부에 노출되지 않도록 주의하세요.
- 대량의 데이터를 처리하는 경우 Telegram API의 요청 제한에 유의하세요.

---

## 6. **문제 해결**

### 6.1 "파일 처리 오류" 메시지 발생

- 파일 인코딩 문제일 수 있습니다. 텍스트 파일이 UTF-8이 아닌 경우, `open` 함수에 적절한 인코딩을 지정하세요.

### 6.2 "채널 다운로드 중 오류 발생" 메시지

- 채널의 권한 문제일 수 있습니다. 텔레그램 채널에서 파일 다운로드 권한이 있는지 확인하세요.

---

이 매뉴얼을 참고하여 코드를 실행하고 필요한 데이터를 처리하세요. 추가 질문이 있으면 언제든 문의하세요!
